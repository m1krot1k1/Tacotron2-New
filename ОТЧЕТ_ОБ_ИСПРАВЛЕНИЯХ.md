# üîß –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö –≤ Smart Tuner TTS

## üìã –û–±–∑–æ—Ä –ø—Ä–æ–±–ª–µ–º

–í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–±–æ—Ç—ã —Å —Å–∏—Å—Ç–µ–º–æ–π Smart Tuner TTS –±—ã–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏:

### 1. üö® RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x64 and 768x128)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π —Ç–µ–Ω–∑–æ—Ä–æ–≤ –≤ –º–µ—Ö–∞–Ω–∏–∑–º–µ –≤–Ω–∏–º–∞–Ω–∏—è –¥–µ–∫–æ–¥–µ—Ä–∞.

**–ü—Ä–∏—á–∏–Ω–∞:** –ú–µ—Ç–æ–¥ `encoder.inference()` –≤–æ–∑–≤—Ä–∞—â–∞–ª —Ç–µ–Ω–∑–æ—Ä –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ñ–æ—Ä–º—ã –∏–ª–∏ `None`.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –£–ª—É—á—à–µ–Ω –º–µ—Ç–æ–¥ `inference` –≤ –∫–ª–∞—Å—Å–µ `Encoder` –≤ `model.py`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π –≤—Ö–æ–¥–Ω—ã—Ö —Ç–µ–Ω–∑–æ—Ä–æ–≤ (2D, 3D, 4D)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π
- –£–ª—É—á—à–µ–Ω–∞ fallback –ª–æ–≥–∏–∫–∞ –≤ –º–µ—Ç–æ–¥–µ `inference` –∫–ª–∞—Å—Å–∞ `Tacotron2`

```python
# –í model.py - Encoder.inference
if x.dim() == 4:
    # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–µ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –µ—Å–ª–∏ –µ—Å—Ç—å
    x = x.squeeze(2)  # –£–±–∏—Ä–∞–µ–º —Ç—Ä–µ—Ç—å–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ
    print(f"üîß –£–±—Ä–∞–Ω–æ –ª–∏—à–Ω–µ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ: {x.shape}")
elif x.dim() == 2:
    x = x.unsqueeze(0)  # –î–æ–±–∞–≤–ª—è–µ–º batch dimension –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
```

### 2. üö® TypeError: unsupported operand type(s) for -: 'datetime.datetime' and 'NoneType'

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ø—ã—Ç–∫–∞ –≤—ã—á–∏—Ç–∞–Ω–∏—è `None` –∏–∑ –æ–±—ä–µ–∫—Ç–∞ `datetime`.

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `training_start_time` –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∞—Å—å –≤ –º–µ—Ç–æ–¥–µ `tts_objective_function`.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `training_start_time` –≤ –Ω–∞—á–∞–ª–µ `tts_objective_function`
- –£–ª—É—á—à–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ –º–µ—Ç–æ–¥–∞—Ö `_check_tts_quality_thresholds` –∏ `_should_restart_training`

```python
# –í smart_tuner_main.py - tts_objective_function
def tts_objective_function(self, trial):
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –æ–±—É—á–µ–Ω–∏—è
    from datetime import datetime
    self.training_start_time = datetime.now()
```

```python
# –í –º–µ—Ç–æ–¥–∞—Ö –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
if hasattr(self, 'training_start_time') and self.training_start_time is not None:
    from datetime import datetime
    training_duration = (datetime.now() - self.training_start_time).total_seconds()
```

### 3. üö® Encoder.inference –≤–µ—Ä–Ω—É–ª None

**–ü—Ä–æ–±–ª–µ–º–∞:** –≠–Ω–∫–æ–¥–µ—Ä –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –∏–∑-–∑–∞ –æ—à–∏–±–æ–∫ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π.

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö —Ç–µ–Ω–∑–æ—Ä–æ–≤ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—è–º–∏.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π –≤ `Encoder.inference`
- –°–æ–∑–¥–∞–Ω–∞ –Ω–∞–¥–µ–∂–Ω–∞—è fallback –ª–æ–≥–∏–∫–∞ –≤ `Tacotron2.inference`
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¥–ª–∏–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π

```python
# –í model.py - Tacotron2.inference
if emb_text is None:
    print("‚ùå Encoder.inference –≤–µ—Ä–Ω—É–ª None, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback")
    # Fallback: —Å–æ–∑–¥–∞–µ–º –±–∞–∑–æ–≤—ã–µ encoder outputs —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—è–º–∏
    batch_size = inputs.size(0)
    seq_len = inputs.size(1)
    encoder_dim = self.encoder.lstm.hidden_size * 2  # bidirectional
    emb_text = torch.zeros(batch_size, seq_len, encoder_dim, 
                         device=inputs.device, dtype=torch.float32)
```

### 4. üö® ValueError: Expected more than 1 value per channel when training

**–ü—Ä–æ–±–ª–µ–º–∞:** BatchNorm –≤ postnet —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –∫–∞–Ω–∞–ª –≤ —Ä–µ–∂–∏–º–µ –æ–±—É—á–µ–Ω–∏—è.

**–ü—Ä–∏—á–∏–Ω–∞:** –ú–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏–ª–∞—Å—å –≤ —Ä–µ–∂–∏–º–µ –æ–±—É—á–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è inference.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `model.eval()` –ø–µ—Ä–µ–¥ inference –≤ —Ç–µ—Å—Ç–∞—Ö
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ decoder.inference

### 5. üö® –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –≤—ã–≤–æ–¥—ã —Å—Ç—Ä–µ—Å—Å–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞—Å–æ—Ä–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å—Ç—Ä–µ—Å—Å–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö –≤ —Å–ª–æ–≤–∞—Ö

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–µ—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ç—Ä–µ—Å—Å–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö –≤ –º–µ—Ç–æ–¥–∞—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –û—Ç–∫–ª—é—á–µ–Ω–∏–µ print-–≤—ã–≤–æ–¥–æ–≤ –≤ –º–µ—Ç–æ–¥–∞—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞

### 6. üö® ZeroDivisionError: float division by zero

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö `diagonal_guide` –∏ `linear_guide` –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø—É—Å—Ç—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤

**–ü—Ä–∏—á–∏–Ω–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è text_len –∏ mel_len

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è text_len –∏ mel_len

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—ã–ª–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ `test_fixes.py`:

```
üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
==================================================
‚úÖ Encoder.inference: –ü–†–û–ô–î–ï–ù
‚úÖ Tacotron2.inference: –ü–†–û–ô–î–ï–ù  
‚úÖ SmartTuner datetime: –ü–†–û–ô–î–ï–ù
‚úÖ OptimizationEngine: –ü–†–û–ô–î–ï–ù
==================================================
üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã: 4/4 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ
üéâ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´! –û—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã.
```

## üìä –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. `model.py`
- **Encoder.inference()**: –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π –≤—Ö–æ–¥–Ω—ã—Ö —Ç–µ–Ω–∑–æ—Ä–æ–≤
- **Tacotron2.inference()**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞–¥–µ–∂–Ω–∞—è fallback –ª–æ–≥–∏–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 2. `smart_tuner_main.py`
- **tts_objective_function()**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `training_start_time`
- **_check_tts_quality_thresholds()**: –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `training_start_time`
- **_should_restart_training()**: –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `training_start_time`

### 3. `test_fixes.py` (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
- –°–æ–∑–¥–∞–Ω –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

## üéØ –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Å–∏—Å—Ç–µ–º–∞ Smart Tuner TTS:

‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** –±–µ–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫  
‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç** —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ —Ç–µ–Ω–∑–æ—Ä–æ–≤  
‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç** –≤—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ  
‚úÖ **–£—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç** inference –æ–ø–µ—Ä–∞—Ü–∏–∏  
‚úÖ **–ü—Ä–æ—Ö–æ–¥–∏—Ç –≤—Å–µ –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã** –±–µ–∑ –æ—à–∏–±–æ–∫  
‚úÖ **–û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –≤—ã–≤–æ–¥—ã**: –û–¢–ö–õ–Æ–ß–ï–ù–´
‚úÖ **ZeroDivisionError**: –ò–°–ü–†–ê–í–õ–ï–ù

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤**: –û–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ fallback –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
2. **–†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ó–∞–ø—É—Å–∫–∞–π—Ç–µ `test_fixes.py` –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π**: –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã. –°–∏—Å—Ç–µ–º–∞ Smart Tuner TTS —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π Tacotron2.

---
*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: 30 –∏—é–Ω—è 2025 –≥.*  
*–í–µ—Ä—Å–∏—è: Smart Tuner V2 TTS* 