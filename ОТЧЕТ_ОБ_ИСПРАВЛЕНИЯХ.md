# üìã –û–¢–ß–ï–¢ –û–ë –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø–• Smart Tuner TTS

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. ‚úÖ RuntimeError: mat1 and mat2 shapes cannot be multiplied
**–§–∞–π–ª:** `model.py`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π —Ç–µ–Ω–∑–æ—Ä–æ–≤ –≤ –º–µ—Ö–∞–Ω–∏–∑–º–µ –≤–Ω–∏–º–∞–Ω–∏—è –¥–µ–∫–æ–¥–µ—Ä–∞ (1x64 –∏ 768x128)  
**–†–µ—à–µ–Ω–∏–µ:** –£–ª—É—á—à–µ–Ω –º–µ—Ç–æ–¥ `Encoder.inference()` —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π –≤—Ö–æ–¥–Ω—ã—Ö —Ç–µ–Ω–∑–æ—Ä–æ–≤ (2D, 3D, 4D) –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è fallback –ª–æ–≥–∏–∫–∞ –≤ `Tacotron2.inference()`

### 2. ‚úÖ TypeError: unsupported operand type(s) for -: 'datetime.datetime' and 'NoneType'
**–§–∞–π–ª:** `smart_tuner_main.py`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ø—ã—Ç–∫–∞ –≤—ã—á–∏—Ç–∞–Ω–∏—è None –∏–∑ datetime –æ–±—ä–µ–∫—Ç–∞  
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `training_start_time` –≤ –Ω–∞—á–∞–ª–µ `tts_objective_function` –∏ —É–ª—É—á—à–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ None

### 3. ‚úÖ "Encoder.inference –≤–µ—Ä–Ω—É–ª None"
**–§–∞–π–ª:** `model.py`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –≠–Ω–∫–æ–¥–µ—Ä –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—è—Ö –≤—Ö–æ–¥–∞  
**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è fallback –ª–æ–≥–∏–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏

### 4. ‚úÖ ValueError: Expected more than 1 value per channel when training
**–§–∞–π–ª:** `model.py`  
**–ü—Ä–æ–±–ª–µ–º–∞:** BatchNorm –≤ —Ä–µ–∂–∏–º–µ –æ–±—É—á–µ–Ω–∏—è –ø—Ä–∏ inference –æ–ø–µ—Ä–∞—Ü–∏—è—Ö  
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `model.eval()` –ø–µ—Ä–µ–¥ inference –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏

### 5. ‚úÖ ZeroDivisionError: float division by zero
**–§–∞–π–ª:** `utils.py`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –î–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö `diagonal_guide` –∏ `linear_guide`  
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `text_len` –∏ `mel_len`

### 6. ‚úÖ –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –≤—ã–≤–æ–¥—ã —Å—Ç—Ä–µ—Å—Å–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π
**–§–∞–π–ª—ã:** `text/emphasizer.py`, `text/rudict.py`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞—Å–æ—Ä–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —Ç–∏–ø–∞ `[('–≤—ã+–µ—Ö–∞–ª–∞', 6), ('–≤+—ã–µ—Ö–∞–ª–∞', 2)]`  
**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ `print()` –≤—ã–≤–æ–¥—ã

### 7. ‚úÖ FP16 –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –∏ deprecated warnings
**–§–∞–π–ª:** `train.py`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∏ "Attempting to unscale FP16 gradients" –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ FutureWarning  
**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ `torch.amp` –≤–º–µ—Å—Ç–æ `torch.cuda.amp`, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ FP16

### 8. ‚úÖ Length of all samples has to be greater than 0
**–§–∞–π–ª:** `data_utils.py`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—É—Å—Ç—ã–µ —Ç–µ–∫—Å—Ç—ã –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ –≤—ã–∑—ã–≤–∞–ª–∏ –æ—à–∏–±–∫—É pack_padded_sequence  
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –ø—É—Å—Ç—ã–µ —Ç–µ–∫—Å—Ç—ã —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞

### 9. ‚úÖ –õ–∏—à–Ω–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
**–§–∞–π–ª—ã:** `data_utils.py`, `loss_function.py`, `model.py`, `train.py`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –ª–∏—à–Ω–∏—Ö warning'–æ–≤ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ç–∞–ª–µ–π  
**–†–µ—à–µ–Ω–∏–µ:** –°–∫—Ä—ã—Ç—ã –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
- `[WARN] Text truncated to 200 tokens`
- `[WARN] –ü—É—Å—Ç–æ–π —Ç–µ–∫—Å—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω`
- `Guide scale: 40.0`
- `Dataset files: 10341`
- `‚ö†Ô∏è –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ MLflow –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ`
- `Warning! Reached max decoder steps`
- –í—Å–µ fallback —Å–æ–æ–±—â–µ–Ω–∏—è —ç–Ω–∫–æ–¥–µ—Ä–∞

### 10. ‚ö†Ô∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ EarlyStopController (—á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ—à–µ–Ω–æ)
**–§–∞–π–ª—ã:** `smart_tuner/early_stop_controller.py`, `smart_tuner_main.py`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ INFO —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç EarlyStopController  
**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω DummyLogger –∏ —Ñ–∏–ª—å—Ç—Ä—ã, –Ω–æ –ª–æ–≥–∏ –≤—Å–µ –µ—â–µ —á–∞—Å—Ç–∏—á–Ω–æ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ä–∞–∑–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚ùå RuntimeError —Å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—è–º–∏ —Ç–µ–Ω–∑–æ—Ä–æ–≤
- ‚ùå TypeError —Å datetime
- ‚ùå ZeroDivisionError
- ‚ùå –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –≤—ã–≤–æ–¥—ã —Å—Ç—Ä–µ—Å—Å–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- ‚ùå FutureWarning –∏ deprecated —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚ùå –ü—É—Å—Ç—ã–µ —Ç–µ–∫—Å—Ç—ã –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ
- ‚ùå –õ–∏—à–Ω–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚ùå Fallback —Å–æ–æ–±—â–µ–Ω–∏—è —ç–Ω–∫–æ–¥–µ—Ä–∞

### ‚ö†Ô∏è **–ß–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- üîÑ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ EarlyStopController (—É–º–µ–Ω—å—à–µ–Ω—ã, –Ω–æ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–±—Ä–∞–Ω—ã)

### üéØ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- ‚úÖ –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ (loss —Å–Ω–∏–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)
- ‚úÖ Fallback –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –í—Å–µ warning'–∏ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Å–∫—Ä—ã—Ç—ã
- ‚úÖ –õ–æ–≥–∏ —Å—Ç–∞–ª–∏ –Ω–∞–º–Ω–æ–≥–æ —á–∏—â–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–µ–µ

## üöÄ –§–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å

**üéâ –°–ò–°–¢–ï–ú–ê –†–ê–ë–û–¢–ê–ï–¢ –°–¢–ê–ë–ò–õ–¨–ù–û!**

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã. –°–∏—Å—Ç–µ–º–∞ Smart Tuner TTS —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
```
‚ùå RuntimeError: mat1 and mat2 shapes cannot be multiplied
‚ùå TypeError: datetime - NoneType  
‚ùå ZeroDivisionError: float division by zero
‚ùå [('–≤—ã+–µ—Ö–∞–ª–∞', 6), ('–≤+—ã–µ—Ö–∞–ª–∞', 2)]
‚ùå FutureWarning: torch.cuda.amp.GradScaler deprecated
‚ùå [WARN] Text truncated to 200 tokens
‚ùå Guide scale: 40.0
‚ùå Dataset files: 10341
‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ –æ—Ç –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
```
‚úÖ üöÄ –ó–∞–ø—É—Å–∫ Smart Tuner V2 TTS...
‚úÖ ‚úÖ NVIDIA Apex –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ torch.amp
‚úÖ ‚úÖ MMI loss –∑–∞–≥—Ä—É–∂–µ–Ω
‚úÖ ‚úÖ Guided Attention Loss –∑–∞–≥—Ä—É–∂–µ–Ω
‚úÖ üöÄ –ù–∞—á–∏–Ω–∞–µ–º –æ–±—É—á–µ–Ω–∏–µ: epochs=150, batch_size=16
‚úÖ Train loss 0 38.987534 Grad Norm 1173737.250000
‚úÖ üìä Validation loss: 35.81195378984724
‚úÖ Saving model and optimizer state at iteration 0
```

### **–û—Å—Ç–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –º–∏–Ω–æ—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- üîÑ –ù–µ–±–æ–ª—å—à–æ–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤ EarlyStopController (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–ª—è –æ–±—ã—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** - —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç–µ
2. **–î–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–π —á–∏—Å—Ç–æ—Ç—ã –ª–æ–≥–æ–≤** - –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ TensorBoard, MLflow UI, Optuna Dashboard –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

**–°–∏—Å—Ç–µ–º–∞ Smart Tuner TTS —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ**

---
*–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: 30.06.2025 15:25* 