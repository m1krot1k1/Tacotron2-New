#!/bin/bash

# üö® –≠–ö–°–¢–†–ï–ù–ù–´–ô –ó–ê–ü–£–°–ö –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø –û–ë–£–ß–ï–ù–ò–Ø
# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏

echo "üö® =============================================="
echo "üö® –≠–ö–°–¢–†–ï–ù–ù–û–ï –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï TACOTRON2"
echo "üö® =============================================="
echo ""

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É
if [[ "$VIRTUAL_ENV" != "" ]]; then
    echo "‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞: $(basename $VIRTUAL_ENV)"
else
    echo "‚ö†Ô∏è –ê–∫—Ç–∏–≤–∏—Ä—É—é –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É..."
    source venv/bin/activate
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤
if [ ! -f "emergency_recovery.py" ]; then
    echo "‚ùå –§–∞–π–ª emergency_recovery.py –Ω–µ –Ω–∞–π–¥–µ–Ω!"
    exit 1
fi

if [ ! -f "smart_tuner/config.yaml" ]; then
    echo "‚ùå –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Smart Tuner –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!"
    exit 1
fi

echo "üõ°Ô∏è –ó–∞–ø—É—Å–∫–∞—é —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ..."
echo "üì± Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –í–ö–õ–Æ–ß–ï–ù–´"
echo "üéØ –¶–µ–ª—å: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å attention –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–æ >50%"
echo "üî• –ò—Å–ø—Ä–∞–≤–∏—Ç—å NaN loss –∏ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ"
echo ""

# –ó–∞–ø—É—Å–∫–∞–µ–º —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
python emergency_recovery.py --notify

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
if [ $? -eq 0 ]; then
    echo ""
    echo "‚úÖ –≠–ö–°–¢–†–ï–ù–ù–û–ï –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û –£–°–ü–ï–®–ù–û!"
    echo "üì± –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç—á–µ—Ç–∞ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö"
else
    echo ""
    echo "‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è"
    echo "üì± –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π –æ—à–∏–±–∫–∏"
    echo "üõ†Ô∏è –í–æ–∑–º–æ–∂–Ω–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ"
fi

echo ""
echo "üö® ==============================================" 