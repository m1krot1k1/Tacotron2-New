# üöÄ –û—Ç—á–µ—Ç –æ–± –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏: enhanced_training_main.py ‚Üí smart_tuner_main.py

## üéØ **–¶–µ–ª—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**
–û–±—ä–µ–¥–∏–Ω–∏—Ç—å –ª—É—á—à–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±–æ–∏—Ö –ø–æ–¥—Ö–æ–¥–æ–≤:
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** –∏–∑ `smart_tuner_main.py`
- **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏** –∏–∑ `enhanced_training_main.py`

## ‚úÖ **–ß—Ç–æ –±—ã–ª–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ**

### üîß **1. EnhancedTrainerWrapper (–Ω–æ–≤—ã–π –∫–ª–∞—Å—Å)**
**–§–∞–π–ª:** `smart_tuner/trainer_wrapper.py`

#### üÜï **–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - 10+ –º–µ—Ç—Ä–∏–∫ –≤ TensorBoard –∏ MLflow
- **–§–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ñ–∞–∑–∞–º–∏
- **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏** - bucket batching, dynamic padding
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ —Ñ–∞–∑–∞–º –æ–±—É—á–µ–Ω–∏—è
- **Debug Reporter** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- **Telegram Monitor Enhanced** - —É–ª—É—á—à–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

#### üìä **–§–∞–∑—ã –æ–±—É—á–µ–Ω–∏—è:**
```python
training_phases = {
    'pre_alignment': {'max_epoch': 500, 'focus': 'attention_learning'},
    'alignment_learning': {'max_epoch': 2000, 'focus': 'attention_stabilization'},
    'quality_optimization': {'max_epoch': 3000, 'focus': 'quality_improvement'},
    'fine_tuning': {'max_epoch': 3500, 'focus': 'final_polishing'}
}
```

### üîß **2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π smart_tuner_main.py**
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ò–º–ø–æ—Ä—Ç `EnhancedTrainerWrapper` –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ä–æ–≥–æ `TrainerWrapper`
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö

## üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**

### ‚úÖ **–¢–µ–ø–µ—Ä—å smart_tuner_main.py –≤–∫–ª—é—á–∞–µ—Ç:**

#### üöÄ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–∫–∞–∫ –±—ã–ª–æ):**
- **–≠–¢–ê–ü 1**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (3-15 trials)
- **–≠–¢–ê–ü 2**: –û–±—É—á–µ–Ω–∏–µ —Å –ª—É—á—à–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

#### üÜï **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω–æ–≤–æ–µ):**
- **10+ –º–µ—Ç—Ä–∏–∫** –≤ TensorBoard:
  - `train/loss`, `val/loss`
  - `quality/attention_alignment`
  - `quality/gate_accuracy`
  - `quality/mel_quality`
  - `hyperparams/learning_rate`
  - `hyperparams/batch_size`
  - –ò –¥—Ä—É–≥–∏–µ...

- **MLflow –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
- **–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤** –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

#### üÜï **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ (–Ω–æ–≤–æ–µ):**
- **Bucket Batching** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞—Ç—á–µ–π –ø–æ –¥–ª–∏–Ω–µ
- **Dynamic Padding** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- **–§–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ** - –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Å—Ç–∞–¥–∏–∏ TTS
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

#### üÜï **–£–ª—É—á—à–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–Ω–æ–≤–æ–µ):**
- **Debug Reporter** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞–∂–¥—ã–µ 1000 —à–∞–≥–æ–≤
- **Telegram Monitor Enhanced** - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ—Ç—á–µ—Ç—ã

## üéØ **–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**

### üöÄ **–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ install.sh (–ø—É–Ω–∫—Ç 3):**
```bash
./install.sh
# –í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç 3
```

### ü§ñ **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. **–ê–Ω–∞–ª–∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** - 3-15 trials
3. **ENHANCED –æ–±—É—á–µ–Ω–∏–µ** - —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - TensorBoard + MLflow + Telegram

### üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
```bash
# TensorBoard
tensorboard --logdir=logs --port=6006 --host=0.0.0.0

# MLflow
mlflow ui --port=5000 --host=0.0.0.0
```

## üèÜ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**

### ‚úÖ **–õ—É—á—à–µ–µ –∏–∑ –æ–±–æ–∏—Ö –º–∏—Ä–æ–≤:**
1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - –ø–æ–¥–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
2. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤–∏–¥–∏—Ç–µ –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏
3. **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏
4. **–§–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ** - –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ —Å—Ç–∞–¥–∏–∏ TTS
5. **–£–ª—É—á—à–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ø–æ–ª–Ω–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞

### ‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- –°—Ç–∞—Ä—ã–π –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- `TrainerWrapper` —Ç–µ–ø–µ—Ä—å –Ω–∞—Å–ª–µ–¥—É–µ—Ç –æ—Ç `EnhancedTrainerWrapper`
- –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã

## üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

### üöÄ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π smart_tuner_main.py –µ—Å–ª–∏:**
- ‚úÖ –•–æ—Ç–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é
- ‚úÖ –ù—É–∂–Ω—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–∏
- ‚úÖ –í–∞–∂–Ω–æ –∫–∞—á–µ—Å—Ç–≤–æ, –∞ –Ω–µ —Å–∫–æ—Ä–æ—Å—Ç—å
- ‚úÖ –ï—Å—Ç—å –≤—Ä–µ–º—è –Ω–∞ –ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å

### üéØ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ enhanced_training_main.py –µ—Å–ª–∏:**
- ‚úÖ –ù—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- ‚úÖ –•–æ—Ç–∏—Ç–µ –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ–º
- ‚úÖ –û–ø—ã—Ç–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å TTS

## üéâ **–ò—Ç–æ–≥**

**–¢–µ–ø–µ—Ä—å `smart_tuner_main.py` (–ø—É–Ω–∫—Ç 3 –≤ install.sh) –≤–∫–ª—é—á–∞–µ—Ç –í–°–ï —É–ª—É—á—à–µ–Ω–∏—è –∏–∑ `enhanced_training_main.py`!**

–í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ:
- ü§ñ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é** –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- üìä **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** (10+ –º–µ—Ç—Ä–∏–∫)
- üöÄ **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏** –æ–±—É—á–µ–Ω–∏—è
- üì± **–£–ª—É—á—à–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
- üéØ **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

**–†–µ–∫–æ–º–µ–Ω–¥—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `smart_tuner_main.py` —á–µ—Ä–µ–∑ `./install.sh` –ø—É–Ω–∫—Ç 3!** üéØ 